Fourth attempt, realised the equation for the boolean distributions was incorrect, so fixed that